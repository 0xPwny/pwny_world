#!/usr/bin/python

#MCSC CTF 2016: Randmizi

#Category : PWN 
#Points : 200 
#Exploit : Abdeljalil Nouiri



##############################
#pwny@local:~/mcsc16/pwn/Randmizi$ python exploit.py s
#[+] i Found it : F 
#pwny@local:~/mcsc16/pwn/Randmizi$ python exploit.py h
#[+] i Found it : [ 
##############################

from subprocess import *
import string
import sys 

keywords = string.printable
file = "./pwn1"
magic = ""


for i in keywords:
	p = Popen([file],stdin=PIPE,stdout=PIPE,stderr=PIPE)
	p.stdin.write(i)
	rez = p.stderr.readline()
	if ":" in rez:
		if sys.argv[1] in rez.split(":")[2]:
			print "[+] i Found it : %s "%i